<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Attendance Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { max-width: 400px; margin: auto; }
        .student { display: flex; align-items: center; margin-bottom: 10px; }
        .student input { margin-right: 10px; }
        button { padding: 10px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="container">
        <h2>Attendance List</h2>
        <div id="studentList"></div>
        <button onclick="submitAttendance()">Submit</button>
    </div>

    <script>
        // Student data from Excel
        const students = [
            {"roll": "1", "name": "Avika Mishra"},
            {"roll": "2", "name": "Khyati Pamidimukkala"},
            {"roll": "3", "name": "Vinshi Manwatkar"},
            {"roll": "4", "name": "Harshal Premraj Keche"},
            {"roll": "5", "name": "Sarthaki Sameer Fuley"},
            {"roll": "6", "name": "Sannidhyaa Giri"},
            {"roll": "7", "name": "Aastha Goyanka"},
            {"roll": "8", "name": "Aditi Paul"},
            {"roll": "9", "name": "Yash Meghraj Gajbhiye"},
            {"roll": "10", "name": "Saksham Boldhan"},
            {"roll": "11", "name": "Maithili Mahajan"},
            {"roll": "12", "name": "Nirali Pradip Banubakode"},
            {"roll": "13", "name": "Pranshul Modani"},
            {"roll": "14", "name": "Aditya Pidurkar"},
            {"roll": "15", "name": "Vidhi Nimbalkar"},
            {"roll": "16", "name": "Samiksha Harkande"},
            {"roll": "17", "name": "Priyansh Jadhav"},
            {"roll": "18", "name": "Saikiran Kotichintala"},
            {"roll": "19", "name": "Samiksha Shukla"},
            {"roll": "20", "name": "Vidhi Nitin Badhiye"}
            // Add all remaining students from the Excel file...
        ];

        function loadStudents() {
            const list = document.getElementById("studentList");
            students.forEach(student => {
                const div = document.createElement("div");
                div.classList.add("student");
                div.innerHTML = `
                    <input type="checkbox" id="${student.roll}" value="${student.roll}">
                    <label for="${student.roll}">${student.roll} - ${student.name}</label>
                `;
                list.appendChild(div);
            });
        }

        function submitAttendance() {
            const selectedRolls = [];
            document.querySelectorAll("input[type='checkbox']:checked").forEach(checkbox => {
                selectedRolls.push(checkbox.value);
            });

            if (selectedRolls.length === 0) {
                alert("No students selected!");
                return;
            }

            // Copy to clipboard
            navigator.clipboard.writeText(selectedRolls.join(", ")).then(() => {
                alert("Roll numbers copied to clipboard!");
            });

            // Send to Discord Webhook
            fetch("https://discord.com/api/webhooks/1354895906641678447/d5Hw0usD2b6CDfavBrbNg3TCdn8DFdfcoXquVwqJx2kcmQAIEhyVUUOAze3gJ2dkGvdi", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ content: selectedRolls.join(", ") })
            }).then(response => {
                if (response.ok) alert("Attendance sent to Discord!");
                else alert("Failed to send attendance.");
            }).catch(error => console.error("Error:", error));
        }

        window.onload = loadStudents;
    </script>

</body>
</html>
